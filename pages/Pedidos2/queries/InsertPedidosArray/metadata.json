{
  "gitSyncId": "68b0fc8d2b07626075282edf_2fa2af40-293d-4d8e-9513-272638dc3d98",
  "id": "Pedidos2_InsertPedidosArray",
  "pluginId": "restapi-plugin",
  "pluginType": "API",
  "unpublishedAction": {
    "actionConfiguration": {
      "autoGeneratedHeaders": [
        {
          "key": "content-type",
          "value": "application/json"
        }
      ],
      "body": "{\n\"_items\": {{\n(Lines.getAll() || []).map((line, idx) => {\nconst norm = (v) =>\nv === undefined || v === null\n? null\n: typeof v === \"string\"\n? v.trim()\n: v;\nconst num = (v) => {\nconst n = Number(v);\nreturn Number.isFinite(n) ? n : null;\n};\n\n  // Cálculos por línea  \n  const montoSinIva = num(line.monto_sin_iva_new ?? line.monto_sin_iva ?? line.precio_unitario);  \n  const montoIva    = montoSinIva !== null ? +(montoSinIva * 0.16).toFixed(2) : null;  \n  const montoTotal  = montoSinIva !== null && montoIva !== null ? +(montoSinIva + montoIva).toFixed(2) : null;  \n\n  return {  \n    id_item_pedido: null,                           // auto en RPC  \n    id_usuario: norm(id_usuario.text),  \n    fecha_pedido: null,  \n    id_cliente: norm(id_cliente_new.text),  \n\n    id_ubicacion: norm(line.id_ubicacion_new),  \n    item_consecutivo: null,                         // auto en RPC  \n    categoria_bano: null,  \n    costo_por_item: montoSinIva,                    // por_línea  \n    fecha_inicio: norm(line.fecha_inicio_new),  \n    fecha_fin: null,  \n\n    monto_sin_iva: montoSinIva,                     // por_línea  \n    monto_iva: montoIva,                            // calculado 16%  \n    monto_total_con_iva: montoTotal,                // sin_iva + iva  \n\n    estatus_pago: null,  \n    id_pedido: null,                                // auto en RPC  \n    fecha_cierre_pedido: null,  \n    estatus_pedido: null,  \n    comodinp_a: null,  \n    comodinp_b: null,  \n    comodinp_c: null,  \n    comodinp_d: null,  \n    comodinp_e: id_item_pedido_new.join(\",\"),  \n\n    id_bano: norm(line.id_bano_new),  \n    id_ruta: norm(line.id_ruta_new),  \n    nombre_ubicacion: norm(line.nombre_ubicacion_new),  \n    geolocalizacion_ubicacion: norm(line.geolocalizacion_ubicacion_new),  \n    estatus_factura: null\t\t\n  };  \n})  \n\n}}\n}",
      "bodyFormData": [],
      "encodeParamsToggle": true,
      "formData": {
        "apiContentType": "application/json"
      },
      "headers": [
        {
          "key": "Authorization",
          "value": "Bearer {{ appsmith.store.access_token }}"
        },
        {
          "key": "apikey",
          "value": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFreHJkcXZpandncnd0dGFzbXVrIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTY1MTM0NzQsImV4cCI6MjA3MjA4OTQ3NH0.71Oe8LUDrw_fTYbaWaLRxYDK9xOaAL1M3AZfY5ldfH4"
        }
      ],
      "httpMethod": "POST",
      "httpVersion": "HTTP11",
      "paginationType": "NONE",
      "path": "/rest/v1/rpc/m07_pedidos_insert_appsmith",
      "pluginSpecifiedTemplates": [
        {
          "value": true
        }
      ],
      "queryParameters": [],
      "timeoutInMillisecond": 10000
    },
    "confirmBeforeExecute": false,
    "datasource": {
      "datasourceConfiguration": {
        "url": "https://akxrdqvijwgrwttasmuk.supabase.co"
      },
      "isAutoGenerated": false,
      "name": "DEFAULT_REST_DATASOURCE",
      "pluginId": "restapi-plugin"
    },
    "dynamicBindingPathList": [
      {
        "key": "headers[0].value"
      },
      {
        "key": "body"
      }
    ],
    "name": "InsertPedidosArray",
    "pageId": "Pedidos2",
    "runBehaviour": "MANUAL",
    "userSetOnLoad": false
  }
}